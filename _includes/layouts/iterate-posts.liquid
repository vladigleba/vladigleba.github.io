{% assign categoryKey = categoryFilter | default: 'All' %}
{% assign summary = allPosts.summaries[categoryKey] %}
{% assign filteredGroupedPosts = allPosts.filteredGroupedPosts[categoryKey] %}

<div class="posts-view">
  {% if not categoryFilter and allPosts.highlightedPosts.featured.size > 0 %}
    {% assign randomFeatured = allPosts.highlightedPosts.featured | sample %}
    {% comment %} {% render 'layouts/featured', featured: randomFeatured, latest: allPosts.highlightedPosts.latest %} {% endcomment %}
  {% endif %}

  {% 
    render 'layouts/controls',
    articleCount: summary.articleCount,
    seriesCount: summary.seriesCount,
    questionsCount: summary.questionsCount
  %}
  
  {% 
    render 'layouts/cards',
    filteredGroupedPosts: filteredGroupedPosts,
    site: site
  %}
</div>